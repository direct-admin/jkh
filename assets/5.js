(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1182:function(e,t,n){"use strict";n.r(t);var r=n(2211),a=n(1395);for(var s in a)"default"!==s&&function(e){n.d(t,e,function(){return a[e]})}(s);n(2294);var o=n(0),i=n(2292),l=n.n(i),c=Object(o.a)(a.default,r.a,r.b,!1,null,null,null);"function"==typeof l.a&&l()(c),t.default=c.exports},1391:function(e,t,n){var r=n(2293);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);(0,n(4).default)("5963161f",r,!0,{})},1392:function(e,t,n){"use strict";function r(e,t,n){return(n=n||[]).length>=t?e.apply(null,n.slice(0,t).reverse()):function(){var a=Array.prototype.slice.call(arguments);return r(e,t,n.concat(a))}}n.d(t,"a",function(){return r})},1393:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=36e5,a=6e4,s=2,o={dateTimeDelimeter:/[T ]/,plainTime:/:/,YY:/^(\d{2})$/,YYY:[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],YYYY:/^(\d{4})/,YYYYY:[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],MM:/^-(\d{2})$/,DDD:/^-?(\d{3})$/,MMDD:/^-?(\d{2})-?(\d{2})$/,Www:/^-?W(\d{2})$/,WwwD:/^-?W(\d{2})-?(\d{1})$/,HH:/^(\d{2}([.,]\d*)?)$/,HHMM:/^(\d{2}):?(\d{2}([.,]\d*)?)$/,HHMMSS:/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,timezone:/([Z+-].*)$/,timezoneZ:/^(Z)$/,timezoneHH:/^([+-])(\d{2})$/,timezoneHHMM:/^([+-])(\d{2}):?(\d{2})$/};function i(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");if(null===e)return new Date(NaN);var n=t||{},i=void 0===n.additionalDigits?s:Number(n.additionalDigits);if(2!==i&&1!==i&&0!==i)throw new RangeError("additionalDigits must be 0, 1 or 2");if(e instanceof Date)return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var c=function(e){var t,n={},r=e.split(o.dateTimeDelimeter);o.plainTime.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var a=o.timezone.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),u=function(e,t){var n,r=o.YYY[t],a=o.YYYYY[t];if(n=o.YYYY.exec(e)||a.exec(e)){var s=n[1];return{year:parseInt(s,10),restDateString:e.slice(s.length)}}if(n=o.YY.exec(e)||r.exec(e)){var i=n[1];return{year:100*parseInt(i,10),restDateString:e.slice(i.length)}}return{year:null}}(c.date,i),d=u.year,p=function(e,t){if(null===t)return null;var n,r,a,s;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=o.MM.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=o.DDD.exec(e)){r=new Date(0);var i=parseInt(n[1],10);return r.setUTCFullYear(t,0,i),r}if(n=o.MMDD.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=o.Www.exec(e))return s=parseInt(n[1],10)-1,l(t,s);if(n=o.WwwD.exec(e)){s=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return l(t,s,u)}return null}(u.restDateString,d);if(p){var f,h=p.getTime(),v=0;return c.time&&(v=function(e){var t,n,s;if(t=o.HH.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*r;if(t=o.HHMM.exec(e))return n=parseInt(t[1],10),s=parseFloat(t[2].replace(",",".")),n%24*r+s*a;if(t=o.HHMMSS.exec(e)){n=parseInt(t[1],10),s=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*r+s*a+1e3*i}return null}(c.time)),c.timezone?f=function(e){var t,n;if(t=o.timezoneZ.exec(e))return 0;if(t=o.timezoneHH.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=o.timezoneHHMM.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(c.timezone):(f=new Date(h+v).getTimezoneOffset(),f=new Date(h+v+f*a).getTimezoneOffset()),new Date(h+v+f*a)}return new Date(e)}function l(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}},1394:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=p(n(11)),a=p(n(10)),s=p(n(1)),o=p(n(3)),i=n(7),l=n(34),c=p(n(2295)),u=p(n(2144)),d=p(n(2289));function p(e){return e&&e.__esModule?e:{default:e}}t.default=(0,o.default)({},(0,i.preload)(["GET_TSA_SETTINGS","GET_TSA_SECRET","GET_TSA_SCRATCH_CODES"]),{computed:(0,o.default)({},(0,i.mapResponse)({GET_TSA_SETTINGS:"values",TSA_GENERATE_SECRET:{secretGenerated:"isDone"},GET_TSA_SECRET:{secret:"response"},GET_TSA_SCRATCH_CODES:"codes"}),{expiryOptions:function(){var e=function(e){return(0,l.toApiDate)(e(Date()))};return[{label:this.$gettext("1 Day"),key:e((0,c.default)(1))},{label:this.$gettext("2 Days"),key:e((0,c.default)(2))},{label:this.$gettext("1 Week"),key:e((0,u.default)(1))},{label:this.$gettext("2 Weeks"),key:e((0,u.default)(2))},{label:this.$gettext("1 Month"),key:e((0,d.default)(1))},{label:this.$gettext("6 Months"),key:e((0,d.default)(6))},{label:this.$gettext("12 Months"),key:e((0,d.default)(12))}].reduce(function(e,t){var n=t.key,r=t.label;return(0,o.default)({},e,(0,s.default)({},n,r))},{0:this.$gettext("Never")})},checkedCodes:function(){return this.checkedRows.map(function(e){return e.code})}}),data:function(){return{code:"",expiry:"0",checkedRows:[],settings:{description:"",enabled:!1,notify:!1,allowApiLogins:!1}}},created:function(){this.settings=(0,o.default)({},this.values)},methods:{generateSecret:function(){var e=this;return(0,a.default)(r.default.mark(function t(){var n;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$request("TSA_GENERATE_SECRET");case 2:(n=t.sent)&&n.success&&(e.$request("GET_TSA_SECRET"),e.$request("GET_TSA_SETTINGS"));case 4:case"end":return t.stop()}},t,e)}))()},testAuthCode:function(){this.$actionRequest("TSA_TEST_AUTH_CODE",this.$get(["code"]))},saveSettings:function(){var e=this;return(0,a.default)(r.default.mark(function t(){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$actionRequest("TSA_SAVE_SETTINGS",{twostep_auth_description:e.settings.description,twostep_auth:e.settings.enabled,api_with_password:e.settings.allowApiLogins,notify_on_all_twostep_auth_failures:e.settings.notify});case 2:case"end":return t.stop()}},t,e)}))()},addCodes:function(){var e=this;return(0,a.default)(r.default.mark(function t(){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$actionRequest("TSA_ADD_SCRATCH_CODES",e.$get(["expiry"]));case 2:t.sent&&e.reloadScratchCodes();case 4:case"end":return t.stop()}},t,e)}))()},reloadScratchCodes:function(){this.$request("GET_TSA_SCRATCH_CODES")},printCodes:function(){document.querySelector("html").classList.add("print-scratch-codes"),window.print()},deleteCodes:function(){var e=this;return(0,a.default)(r.default.mark(function t(){return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$actionRequest("TSA_DELETE_SCRATCH_CODES",{select:e.checkedCodes});case 2:t.sent&&(e.reloadScratchCodes(),e.checkedRows=[]);case 4:case"end":return t.stop()}},t,e)}))()}}})},1395:function(e,t,n){"use strict";n.r(t);var r=n(1394),a=n.n(r);for(var s in r)"default"!==s&&function(e){n.d(t,e,function(){return r[e]})}(s);t.default=a.a},2018:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1393);function a(e,t,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var a=Object(r.a)(e,n),s=Number(t);return a.setDate(a.getDate()+s),a}},2144:function(e,t,n){"use strict";n.r(t);var r=n(2018);var a=n(1392),s=Object(a.a)(function(e,t,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var a=7*Number(t);return Object(r.a)(e,a,n)},2);t.default=s},2211:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("app-page",{attrs:{id:"two-step-auth"}},[n("ui-button",{attrs:{slot:"header:buttons",theme:"safe"},on:{click:function(t){e.$dialog("ADD_CODES_DIALOG").open()}},slot:"header:buttons"},[n("translate",[e._v("Add Codes")])],1),e._v(" "),n("div",{directives:[{name:"flex",rawName:"v-flex",value:{cross:"center"},expression:"{ cross: 'center' }"}],attrs:{slot:"page:title"},slot:"page:title"},[n("translate",[e._v("\n            Two-Step Authentication\n        ")]),e._v(" "),n("ui-tooltip",{directives:[{name:"margin",rawName:"v-margin",value:[,,,1],expression:"[,,,1]"}],attrs:{placement:"bottom"}},[n("span",{directives:[{name:"translate",rawName:"v-translate"}]},[n("p",[e._v("\n                    To use this feature, download the Google Authenticator App for your phone (or equivalent), and scan in the QR code.\n                ")]),e._v(" "),n("p",[e._v("\n                    The App will show you a code, which you'll use to Login to DirectAdmin.\n                ")]),e._v(" "),n("p",[e._v("\n                    Scratch Codes are one-time use codes in case you don't have your phone, so keep them safe.\n                ")])])])],1),e._v(" "),e.settings.enabled||e.secretGenerated?e._e():n("app-page-section",[n("translate",{attrs:{tag:"strong"}},[e._v("This feature is not turned on.")]),e._v(" "),e.values.requireGeneration?n("translate",[e._v("Create a new secret to begin.")]):e._e()],1),e._v(" "),n("app-page-section",[e.values.requireGeneration?e._e():n("ui-form-element",[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Secret")]),e._v(" "),n("ui-input-group",{attrs:{slot:"content"},slot:"content"},[n("input-text",{attrs:{slot:"additions:left",value:e.secret.value,disabled:""},slot:"additions:left"}),e._v(" "),n("ui-button",{attrs:{slot:"input",theme:"light"},slot:"input"},[n("translate",{staticClass:"wrap:nowrap"},[e._v("\n                        Generate Secret\n                    ")])],1),e._v(" "),n("ui-tooltip",{attrs:{slot:"additions:right"},slot:"additions:right"},[n("ui-button",{attrs:{slot:"trigger",theme:"light"},slot:"trigger"},[n("ui-icon",{attrs:{id:"question",size:"medium",theme:"primary"}})],1),e._v(" "),n("translate",[e._v("\n                        Be sure to re-scan the QR code, as all old codes become invalid.\n                    ")])],1)],1),e._v(" "),e._e()],1),e._v(" "),e.values.requireGeneration?e._e():n("ui-form-element",[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("QR Code")]),e._v(" "),n("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column",cross:e.$_Client.isPhone?"stretch":"start"},expression:"{\n                dir: 'column',\n                cross: $_Client.isPhone ? 'stretch' : 'start'\n            }"}],attrs:{slot:"content"},slot:"content"},[n("img",{attrs:{src:e.secret.qr,width:e.$_Client.isPhone?"100%":"200",title:e.$gettext("Scan this code in your phone")}}),e._v(" "),n("ui-input-group",[n("input-text",{attrs:{slot:"input",number:"",placeholder:e.$gettext("Test your phone's code")},slot:"input",model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),e._v(" "),n("ui-button",{attrs:{slot:"additions:right",disabled:!e.code},on:{click:e.testAuthCode},slot:"additions:right"},[n("translate",[e._v("\n                            Test Code\n                        ")])],1)],1)],1)],1),e._v(" "),n("ui-form-element",[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Description")]),e._v(" "),n("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.settings.description,callback:function(t){e.$set(e.settings,"description",t)},expression:"settings.description"}})],1),e._v(" "),n("ui-form-element",[n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:e.settings.enabled,callback:function(t){e.$set(e.settings,"enabled",t)},expression:"settings.enabled"}},[n("translate",[e._v("\n                        Require valid Two-Step Authentication Code to login to this account.\n                    ")])],1)],1),e._v(" "),n("ui-form-element",[n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:e.settings.notify,callback:function(t){e.$set(e.settings,"notify",t)},expression:"settings.notify"}},[n("translate",[e._v("\n                        Allow API logins with the current User/password. Login Keys and Session Keys are always allowed.\n                    ")])],1)],1),e._v(" "),n("ui-form-element",[n("input-checkbox",{attrs:{slot:"content"},slot:"content",model:{value:e.settings.allowApiLogins,callback:function(t){e.$set(e.settings,"allowApiLogins",t)},expression:"settings.allowApiLogins"}},[n("translate",[e._v("\n                        Notify me on all incorrect codes entries. Disabling this option will still notify you after 5 failed attempts.\n                    ")])],1)],1),e._v(" "),n("div",{directives:[{name:"flex",rawName:"v-flex",value:{main:"end"},expression:"{ main: 'end' }"},{name:"margin",rawName:"v-margin",value:"1rem",expression:"'1rem'"}]},[n("ui-button",{attrs:{theme:"primary"},on:{click:e.saveSettings}},[n("translate",[e._v("Save")])],1)],1)],1),e._v(" "),n("app-page-section",{attrs:{id:"scratch-codes"}},[n("translate",{attrs:{slot:"section:title"},slot:"section:title"},[e._v("Scratch Codes")]),e._v(" "),n("template",{slot:"section:buttons"},[n("ui-button",{attrs:{theme:"primary"},on:{click:function(t){e.$dialog("ADD_CODES_DIALOG").open()}}},[n("translate",[e._v("Add Codes")])],1),e._v(" "),n("ui-button",{attrs:{theme:"safe"},on:{click:e.printCodes}},[n("translate",[e._v("Print")])],1)],1),e._v(" "),n("ui-table",{attrs:{rows:e.codes,columns:[{id:"code",label:e.$gettext("Scratch Code"),editable:!1},{id:"created",label:e.$gettext("Date Created")},{id:"expiry",label:e.$gettext("Expires")}],rowsCount:e.codes.length,checkedRows:e.checkedRows,verticalLayout:e.$_Client.isPhone,disablePagination:"",equalWidthLayout:""},on:{"update:checkedRows":function(t){e.checkedRows=t}},scopedSlots:e._u([{key:"col:created",fn:function(t){var n=t.created;return[e._v("\n                "+e._s(e._f("date")(n))+"\n            ")]}},{key:"col:expiry",fn:function(t){var r=t.expiry;return[r?[e._v("\n                    "+e._s(e._f("date")(r))+"\n                ")]:n("translate",[e._v("Never")])]}}])},[n("ui-table-action",{attrs:{slot:"table:actions"},on:{click:e.deleteCodes},slot:"table:actions"},[n("translate",[e._v("Delete")])],1)],1)],2),e._v(" "),n("ui-dialog",{attrs:{id:"ADD_CODES_DIALOG"}},[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Add Scratch Codes")]),e._v(" "),n("div",{attrs:{slot:"content"},slot:"content"},[n("translate",[e._v("\n                Scratch Codes are one-time use codes in case you don't have your phone, so keep them safe.\n            ")]),e._v(" "),n("ui-form-element",[n("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Expiry")]),e._v(" "),n("input-usual-select",{attrs:{slot:"content",options:e.expiryOptions},slot:"content",model:{value:e.expiry,callback:function(t){e.expiry=t},expression:"expiry"}})],1)],1),e._v(" "),n("ui-button",{attrs:{slot:"buttons",theme:"primary"},on:{click:e.addCodes},slot:"buttons"},[n("translate",[e._v("Add Codes")])],1)],1)],1)},a=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})},2289:function(e,t,n){"use strict";n.r(t);var r=n(1393);var a=n(1392),s=Object(a.a)(function(e,t,n){if(arguments.length<2)throw new TypeError("2 arguments required, but only "+arguments.length+" present");var a=Object(r.a)(e,n),s=Number(t),o=a.getMonth()+s,i=new Date(0);i.setFullYear(a.getFullYear(),o,1),i.setHours(0,0,0,0);var l=function(e,t){if(arguments.length<1)throw new TypeError("1 argument required, but only "+arguments.length+" present");var n=Object(r.a)(e,t),a=n.getFullYear(),s=n.getMonth(),o=new Date(0);return o.setFullYear(a,s+1,0),o.setHours(0,0,0,0),o.getDate()}(i,n);return a.setMonth(o,Math.min(l,a.getDate())),a},2);t.default=s},2292:function(e,t){},2293:function(e,t,n){(e.exports=n(5)(!0)).push([e.i,"@media print{html.print-scratch-codes #two-step-auth>*,html.print-scratch-codes footer,html.print-scratch-codes header.header,html.print-scratch-codes section.search{display:none}html.print-scratch-codes #scratch-codes{display:block}html.print-scratch-codes #scratch-codes .button,html.print-scratch-codes #scratch-codes h2,html.print-scratch-codes #scratch-codes input{display:none}html.print-scratch-codes #scratch-codes .table-row{background-color:#fff}}","",{version:3,sources:["/usr/local/directadmin/data/skins/evolution/src/js/pages/user/two-step-auth.vue"],names:[],mappings:"AA8VA,aACI,yJAEyB,YAAa,CAFtC,wCAIQ,aAAc,CAJtB,yIAMY,YAAa,CANzB,mDASY,qBAAsB,CACzB,CAAA",file:"two-step-auth.vue?vue&type=style&index=0&lang=scss",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@media print {\n    html.print-scratch-codes {\n        header.header, footer, section.search { display: none; }\n        #two-step-auth > * { display: none; }\n        #scratch-codes {\n            display: block;\n            .button, h2, input {\n                display: none;\n            }\n            .table-row {\n                background-color: #fff;\n            }\n        }\n    }\n}\n"],sourceRoot:""}])},2294:function(e,t,n){"use strict";var r=n(1391);n.n(r).a},2295:function(e,t,n){"use strict";n.r(t);var r=n(2018),a=n(1392),s=Object(a.a)(r.a,2);t.default=s}}]);